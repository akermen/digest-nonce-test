#------------------------------------------------------------------------------
#
#  Makefile
#
#  Created by Ahmet Kermen on 14.01.2022.
#
#------------------------------------------------------------------------------
all: build serve
#------------------------------------------------------------------------------
ROOT_PATH := $(shell dirname $(abspath $(lastword $(MAKEFILE_LIST))))
#------------------------------------------------------------------------------
VERSION='0.9.72'
#------------------------------------------------------------------------------
build:
	@docker build \
		--progress plain \
		--build-arg VERSION=${VERSION} \
		--tag digest-nonce-test:${VERSION} \
		-f ${ROOT_PATH}/Dockerfile .
#------------------------------------------------------------------------------
serve:
	@docker run \
		--rm \
		-it \
		-p 8080:8080 \
		--name digest-nonce-test \
		digest-nonce-test:${VERSION}
#------------------------------------------------------------------------------
test:
	@python ${ROOT_PATH}/nonce-test.py
#------------------------------------------------------------------------------
test-second:
	@python ${ROOT_PATH}/nonce-test.py second
#------------------------------------------------------------------------------
.PHONY: all serve test test-second
#------------------------------------------------------------------------------
